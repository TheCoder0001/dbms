Consider following Relation
Account(Acc_no, branch_name,balance)
Branch(branch_name,branch_city,assets)
Customer(cust_name,cust_street,cust_city)
Depositor(cust_name,acc_no)
Loan(loan_no,branch_name,amount)
Borrower(cust_name,loan_no)
Create above tables with appropriate constraints like primary
key, foreign key, not null etc.
1. Find the branches where average account balance > 15000.
2. Find number of tuples in customer relation.
3. Calculate total loan amount given by bank.
4. Delete all loans with loan amount between 1300 and 1500.
5. Find the average account balance at each branch
6. Find name of Customer and city where customer name starts with
Letter P. 


CREATE TABLE Branch(
  branch_name VARCHAR(30) PRIMARY KEY,
  branch_city VARCHAR(30),
  assets INT
);

CREATE TABLE Account(
  acc_no INT PRIMARY KEY,
  branch_name VARCHAR(30),
  balance INT,
  FOREIGN KEY(branch_name) REFERENCES Branch(branch_name)
);

CREATE TABLE Customer(
  cust_name VARCHAR(30) PRIMARY KEY,
  cust_street VARCHAR(30),
  cust_city VARCHAR(30)
);

CREATE TABLE Depositor(
  cust_name VARCHAR(30),
  acc_no INT,
  PRIMARY KEY(cust_name, acc_no),
  FOREIGN KEY(cust_name) REFERENCES Customer(cust_name),
  FOREIGN KEY(acc_no) REFERENCES Account(acc_no)
);

CREATE TABLE Loan(
  loan_no INT PRIMARY KEY,
  branch_name VARCHAR(30),
  amount INT,
  FOREIGN KEY(branch_name) REFERENCES Branch(branch_name)
);

CREATE TABLE Borrower(
  cust_name VARCHAR(30),
  loan_no INT,
  PRIMARY KEY(cust_name, loan_no),
  FOREIGN KEY(cust_name) REFERENCES Customer(cust_name),
  FOREIGN KEY(loan_no) REFERENCES Loan(loan_no)
);
INSERT INTO Branch VALUES 
('Wadia College','Pune',500000),
('Pune_Station','Pune',450000),
('Camp','Pune',350000);

INSERT INTO Account VALUES 
(101,'Wadia College',18000),
(102,'Camp',25000),
(103,'Pune_Station',30000);

INSERT INTO Customer VALUES 
('Rahul','MG Road','Pune'),
('Neha','Station Road','Pune'),
('Amit','Camp','Pune');

INSERT INTO Depositor VALUES 
('Rahul',101),
('Neha',102),
('Amit',103);

INSERT INTO Loan VALUES 
(501,'Wadia College',15000),
(502,'Pune_Station',12000),
(503,'Wadia College',20000);

INSERT INTO Borrower VALUES 
('Rahul',501),
('Neha',502),
('Amit',503);

SELECT branch_name
FROM Account
GROUP BY branch_name
HAVING AVG(balance) > 15000;


SELECT COUNT(*) AS total_customers FROM Customer;


SELECT SUM(amount) AS total_loan_amount FROM Loan;


DELETE FROM Loan
WHERE amount BETWEEN 1300 AND 1500;


SELECT branch_name, AVG(balance) AS avg_balance
FROM Account
GROUP BY branch_name;


SELECT cust_name, cust_city
FROM Customer
WHERE cust_name LIKE 'P%';
