Write a PL/SQL block of code using Cursor that will merge the
data available in the newly created table N_Roll Call with the
data available in the table O_RollCall. If the data in the first
table already exist in the second table then that data should be
skipped.


CREATE TABLE O_RollCall(Roll NUMBER PRIMARY KEY, Name VARCHAR2(30));
CREATE TABLE N_RollCall(Roll NUMBER, Name VARCHAR2(30));

INSERT INTO O_RollCall VALUES (1,'Amit');
INSERT INTO O_RollCall VALUES (2,'Neha');

INSERT INTO N_RollCall VALUES (2,'Neha');
INSERT INTO N_RollCall VALUES (3,'Raj');

DECLARE
  CURSOR c1 IS SELECT * FROM N_RollCall;
  v_roll NUMBER;
  v_name VARCHAR2(30);
  v_count NUMBER;
BEGIN
  OPEN c1;
  LOOP
    FETCH c1 INTO v_roll, v_name;
    EXIT WHEN c1%NOTFOUND;
   
    SELECT COUNT(*) INTO v_count FROM O_RollCall WHERE Roll=v_roll;
    IF v_count = 0 THEN
      INSERT INTO O_RollCall VALUES (v_roll, v_name);
    END IF;
  END LOOP;
  CLOSE c1;
END;
/


OR

DECLARE
  CURSOR c IS SELECT * FROM N_RollCall;
  v_roll N_RollCall.Roll%TYPE;
  v_name N_RollCall.Name%TYPE;
BEGIN
  OPEN c;
  LOOP
    FETCH c INTO v_roll, v_name;
    EXIT WHEN c%NOTFOUND;
    INSERT INTO O_RollCall SELECT v_roll, v_name FROM dual
      WHERE NOT EXISTS (SELECT * FROM O_RollCall WHERE Roll=v_roll);
  END LOOP;
  CLOSE c;
END;
/
