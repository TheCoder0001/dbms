Consider following Relation
Account(Acc_no, branch_name,balance)
Branch(branch_name,branch_city,assets)
Customer(cust_name,cust_street,cust_city)
Depositor(cust_name,acc_no)
Loan(loan_no,branch_name,amount)
Borrower(cust_name,loan_no)
Create above tables with appropriate constraints like primary
key, foreign key, not null etc.
1. Find the names of all branches in loan relation.
2. Find all loan numbers for loans made at „Wadia College‟ Branch
with loan amount > 12000.
3. Find all customers who have a loan from bank. Find their
names,loan_no and loan amount.
4. List all customers in alphabetical order who have loan from
„Wadia College‟ branch.
5. Display distinct cities of branch.



CREATE TABLE Branch(
  branch_name VARCHAR(30) PRIMARY KEY,
  branch_city VARCHAR(30),
  assets INT
);

CREATE TABLE Account(
  acc_no INT PRIMARY KEY,
  branch_name VARCHAR(30),
  balance INT,
  FOREIGN KEY(branch_name) REFERENCES Branch(branch_name)
);

CREATE TABLE Customer(
  cust_name VARCHAR(30) PRIMARY KEY,
  cust_street VARCHAR(30),
  cust_city VARCHAR(30)
);

CREATE TABLE Depositor(
  cust_name VARCHAR(30),
  acc_no INT,
  PRIMARY KEY(cust_name, acc_no),
  FOREIGN KEY(cust_name) REFERENCES Customer(cust_name),
  FOREIGN KEY(acc_no) REFERENCES Account(acc_no)
);

CREATE TABLE Loan(
  loan_no INT PRIMARY KEY,
  branch_name VARCHAR(30),
  amount INT,
  FOREIGN KEY(branch_name) REFERENCES Branch(branch_name)
);

CREATE TABLE Borrower(
  cust_name VARCHAR(30),
  loan_no INT,
  PRIMARY KEY(cust_name, loan_no),
  FOREIGN KEY(cust_name) REFERENCES Customer(cust_name),
  FOREIGN KEY(loan_no) REFERENCES Loan(loan_no)
);
INSERT INTO Branch VALUES 
('Wadia College','Pune',500000),
('Pune_Station','Pune',450000),
('Camp','Pune',350000);

INSERT INTO Account VALUES 
(101,'Wadia College',18000),
(102,'Camp',25000),
(103,'Pune_Station',30000);

INSERT INTO Customer VALUES 
('Rahul','MG Road','Pune'),
('Neha','Station Road','Pune'),
('Amit','Camp','Pune');

INSERT INTO Depositor VALUES 
('Rahul',101),
('Neha',102),
('Amit',103);

INSERT INTO Loan VALUES 
(501,'Wadia College',15000),
(502,'Pune_Station',12000),
(503,'Wadia College',20000);

INSERT INTO Borrower VALUES 
('Rahul',501),
('Neha',502),
('Amit',503);


SELECT DISTINCT branch_name FROM Loan;

SELECT loan_no 
FROM Loan 
WHERE branch_name='Wadia College' AND amount > 12000;

SELECT Borrower.cust_name, Borrower.loan_no, Loan.amount
FROM Borrower
JOIN Loan ON Borrower.loan_no = Loan.loan_no;

SELECT Borrower.cust_name
FROM Borrower
JOIN Loan ON Borrower.loan_no = Loan.loan_no
WHERE Loan.branch_name='Wadia College'
ORDER BY Borrower.cust_name ASC;


SELECT DISTINCT branch_city FROM Branch;

